template_path: eks_cluster.tf
environment: dev
region: eu-west-1

# EKS_managed_nodes
managed_nodes: true
node_groups:
  group_1:
    node_group_name: node-general_1
    node_group_desired_size: 1
    node_group_max_size: 3
    node_group_min_size: 1
    node_group_ami_type: AL2_x86_64
    node_group_capacity_type: ON_DEMAND
    node_group_disk_size: 20
    node_group_force_update_version: false
    node_group_instance_type: t3.medium
    node_group_role_label: node-general-1
    node_group_subnets: { sub}  

# EKS

eks_cluster_name: eks
eks_endpoint_private_access: false
eks_endpoint_public_access: true

# VPC

vpc: true

external_subnets_private:
  - var.vpc_private_subnet_1
  - var.vpc_private_subnet_2
external_subnets_public:
  - var.vpc_public_subnet_1
  - var.vpc_public_subnet_2

eks_vpc_cidr_block: "192.168.0.0/16"
eks_vpc_instance_tenancy: default
eks_vpc_enable_dns_support: true
eks_vpc_enable_dns_hostnames: true
vpc_tags: {
  'Name':'test-eks-vpc',
  'Environment':'dev'
  }

# Subnet

subnets_public:
  subnet_1:
    cidr_block: "192.168.0.0/18"
    availability_zone: "us-east-2a"
    map_public_ip_on_launch: true
    tags: {
     'Name':'public-eu-west-2a',
     'kubernetes.io/cluster/eks': 'shared',
     'kubernetes.io/role/elb': '1'
     }
    tags_nat_gateway: {
      'Name':'EKS NAT 1',
     }
  subnet_2:
    cidr_block: "192.168.64.0/18"
    availability_zone: "us-east-2b"
    map_public_ip_on_launch: true
    tags: {
     'Name':'public-eu-west-2b',
     'kubernetes.io/cluster/eks': 'shared',
     'kubernetes.io/role/elb': '1'
      }
    tags_nat_gateway: {
      'Name':'EKS NAT 2',
     }

subnets_private:
  subnet_1:
    cidr_block: "192.168.128.0/18"
    availability_zone: "us-east-2a"
    route_table_cidr_block: 0.0.0.0/0
    for_nat_gateway_public: subnet_1
    tags: {
     'Name':'private-eu-west-2a',
     'kubernetes.io/cluster/eks': 'shared',
     'kubernetes.io/role/internal-elb': '1'
      }
    private_route_table_tags: {
      'Name':'PrivateRouteTable1',
    }     
  subnet_2:
    cidr_block: "192.168.192.0/18"
    availability_zone: "us-east-2b"
    route_table_cidr_block: 0.0.0.0/0
    for_nat_gateway_public: subnet_2
    tags: {
     'Name':'private-eu-west-2b',
     'kubernetes.io/cluster/eks': 'shared',
     'kubernetes.io/role/internal-elb': '1'
      }
    private_route_table_tags: {
      'Name':'PrivateRouteTable2',
    }   

efs_file_system: true
efs_file_system_performance_mode: generalPurpose
efs_file_system_encrypted: true
efs_mount_target: 
  - mount_target: target_1
    for_private_subnet: subnet_1
  - mount_target: target_2
    for_private_subnet: subnet_2

# SG
sg_name_prefix: "eks-sg"
ingress: 
  ingres1: 
    from_port: 2049
    to_port: 2049
    protocol: "tcp" 
    cidr_blocks: '["192.168.0.0/16"]'
  ingres2: 
    from_port: 22 
    to_port: 22
    protocol: "tcp"
    cidr_blocks: '["0.0.0.0/0","192.168.2.0/24"]'
egress:  
  egress1: 
    from_port: 0 
    to_port: 0
    protocol: "-1"
    cidr_blocks: '["0.0.0.0/0"]'
    ipv6_cidr_blocks: ::/0

sg_tags: {
  'Name':'eks-efs' 
  }
    
# Route table
public_route_table_cidr_block: 0.0.0.0/0

internet_gateway_tags: {
   'Name':'EKS Internet Gateway',
}
# Auth_Update
auth_user:
  - username: daniel
    cluster: eks
    region: eu-west-2
    arn:  # your user arn
 